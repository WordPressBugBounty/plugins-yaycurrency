!function (e, r) { YayCurrency_Callback = r.YayCurrency_Callback || {}, yay_currency_data_args = { common_data_args: { yayCurrencySymbolWrapper: "span.woocommerce-Price-currencySymbol", yayCurrencySwitcher: ".yay-currency-single-page-switcher", yayCurrencyWidget: ".yay-currency-widget-switcher", yayCurrencyBlock: ".yay-currency-block-switcher", yayCurrencyCartContents: "a.cart-contents" }, converter_args: { converterWrapper: ".yay-currency-converter-container", converterAmount: ".yay-currency-converter-amount", converterFrom: ".yay-currency-converter-from-currency", converterTo: ".yay-currency-converter-to-currency", converterResultWrapper: ".yay-currency-converter-result-wrapper", converterResultAmount: ".yay-currency-converter-amount-value", converterResultFrom: ".yay-currency-converter-from-currency-code", converterResultValue: ".yay-currency-converter-result-value", converterResultTo: ".yay-currency-converter-to-currency-code" }, switcher_data_args: { activeClass: "active", upwardsClass: "upwards", openClass: "open", selectedClass: "selected", currencySwitcher: ".yay-currency-switcher", currencyFlag: ".yay-currency-flag", currencySelectedFlag: ".yay-currency-flag.selected", customLoader: ".yay-currency-custom-loader", customOption: ".yay-currency-custom-options", customArrow: ".yay-currency-custom-arrow", customOptionArrow: ".yay-currency-custom-option-row", customOptionArrowSelected: ".yay-currency-custom-option-row.selected", selectTrigger: ".yay-currency-custom-select__trigger", selectWrapper: ".yay-currency-custom-select-wrapper", customSelect: ".yay-currency-custom-select", selectedOption: ".yay-currency-custom-select__trigger .yay-currency-selected-option" }, blocks_data_args: { checkout: ".wp-block-woocommerce-checkout[data-block-name='woocommerce/checkout']", cart: ".wp-block-woocommerce-cart[data-block-name='woocommerce/cart']" }, cookies_data_args: { cartBlocks: "yay_cart_blocks_page", checkoutBlocks: "yay_checkout_blocks_page" } }, YayCurrency_Callback.Helper = { setCookie: function (e, r, t) { var c = ""; if (t) { var o = new Date; o.setTime(o.getTime() + 864e5 * t), c = "; expires=" + o.toUTCString() } document.cookie = e + "=" + (r || "") + c + "; path=/" }, getCookie: function (e) { let r = e + "=", t = decodeURIComponent(document.cookie).split(";"); for (let c = 0; c < t.length; c++) { let o = t[c]; for (; " " == o.charAt(0);)o = o.substring(1); if (0 == o.indexOf(r)) return o.substring(r.length, o.length) } return "" }, deleteCookie: function (e) { YayCurrency_Callback.Helper.setCookie(e, "", -1) }, getCurrentCurrency: function (e = !1) { e = e || YayCurrency_Callback.Helper.getCookie(r.yayCurrency.cookie_name); let t = !1; return r.yayCurrency.converted_currency && r.yayCurrency.converted_currency.forEach(r => { r.ID === +e && (t = r) }), t }, getRateFeeByCurrency: function (e = !1) { let r = parseFloat((e = e || YayCurrency_Callback.Helper.getCurrentCurrency()).rate); return "percentage" === e.fee.type ? parseFloat(e.rate) + parseFloat(e.rate) * (parseFloat(e.fee.value) / 100) : parseFloat(e.rate) + parseFloat(e.fee.value) }, getBlockData: function () { let r = {}; if (e(yay_currency_data_args.common_data_args.yayCurrencyBlock).length) { let t = e(yay_currency_data_args.common_data_args.yayCurrencyBlock); r.isShowFlag = t.data("show-flag"), r.isShowCurrencyName = t.data("show-currency-name"), r.isShowCurrencySymbol = t.data("show-currency-symbol"), r.isShowCurrencyCode = t.data("show-currency-code"), r.widgetSize = t.data("switcher-size") } return r }, blockLoading: function (r) { e(r).addClass("processing").block({ message: null, overlayCSS: { background: "#fff", opacity: .6 } }) }, unBlockLoading: function (r) { e(r).removeClass("processing").unblock() }, switcherUpwards: function () { let t = e(yay_currency_data_args.common_data_args.yayCurrencySwitcher); t.each(function () { let t = e(this).offset().top + e(this).height() - e(r).scrollTop(), c = e(r).height() - e(this).height() - e(this).offset().top + e(r).scrollTop(); c < 250 && t > 250 ? (e(this).find(yay_currency_data_args.switcher_data_args.customOption).addClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.customArrow).addClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.selectTrigger).addClass(yay_currency_data_args.switcher_data_args.upwardsClass)) : (e(this).find(yay_currency_data_args.switcher_data_args.customOption).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.customArrow).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.selectTrigger).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass)) }) }, switcherAction: function () { let t = yay_currency_data_args.switcher_data_args; e(document).on("click", t.selectWrapper, function () { e(t.customSelect, this).toggleClass(t.openClass), e("#slide-out-widget-area").find(t.customOption).toggleClass("overflow-fix"), e("[id^=footer]").toggleClass("z-index-fix"), e(t.customSelect, this).parents(".handheld-navigation").toggleClass("overflow-fix") }), e(document).on("click", t.customOptionArrow, function () { let r = e(this).data("value") ? e(this).data("value") : e(this).data("currency-id"), c = e(this).children(t.currencyFlag).data("country_code"); if (YayCurrency_Callback.Helper.refreshCartFragments(), e(t.currencySwitcher).val(r).change(), !e(this).hasClass(t.selectedClass)) { let o = e(this).closest(t.customSelect); e(this).parent().find(t.customOptionArrowSelected).removeClass(t.selectedClass), e(this).addClass(t.selectedClass), o.find(t.currencySelectedFlag).css({ background: `url(${yayCurrency.yayCurrencyPluginURL}assets/dist/flags/${c}.svg)` }), o.find(t.selectedOption).text(e(this).text()), o.find(t.customLoader).addClass(t.activeClass), o.find(t.customArrow).hide() } }), r.addEventListener("click", function (e) { let r = document.querySelectorAll(yay_currency_data_args.switcher_data_args.customSelect); r.forEach(r => { r.contains(e.target) || r.classList.remove(yay_currency_data_args.switcher_data_args.openClass) }) }) }, refreshCartFragments: function () { "undefined" != typeof wc_cart_fragments_params && null !== wc_cart_fragments_params && sessionStorage.removeItem(wc_cart_fragments_params.fragment_name) }, detectCheckoutBlocks: function () { return !!e(yay_currency_data_args.blocks_data_args.checkout).length }, detectCartBlocks: function () { return !!e(yay_currency_data_args.blocks_data_args.cart).length }, reCalculateCartSubtotalCheckoutBlocksPage: function () { let r = yay_currency_data_args.cookies_data_args.checkoutBlocks; if (YayCurrency_Callback.Helper.deleteCookie(r), YayCurrency_Callback.Helper.detectCheckoutBlocks() && (YayCurrency_Callback.Helper.setCookie(r, "yes", 1), yayCurrency.checkout_notice_html)) { "" != yayCurrency.checkout_notice_html && e(yay_currency_data_args.blocks_data_args.checkout).before(yayCurrency.checkout_notice_html); let t = yay_currency_data_args.common_data_args.yayCurrencyCartContents; e(document.body).on("wc_fragments_refreshed", function () { e.ajax({ url: yayCurrency.ajaxurl, type: "POST", data: { action: "yayCurrency_get_cart_subtotal_default_blocks", nonce: yayCurrency.nonce }, beforeSend: function (e) { YayCurrency_Callback.Helper.blockLoading(t) }, xhrFields: { withCredentials: !0 }, success: function r(c) { YayCurrency_Callback.Helper.unBlockLoading(t), c.success && c.data.cart_subtotal && e(t).find(".woocommerce-Price-amount.amount").html(c.data.cart_subtotal) }, error: function (e, r, c) { YayCurrency_Callback.Helper.unBlockLoading(t), console.log("Error responseText: ", e.responseText) } }) }) } }, getCurrentCurrencyByCode: function (e = !1, t = !1) { e = e || r.yayCurrency.default_currency_code; let c = !1; return (t = t || r.yayCurrency.converted_currency) && t.forEach(r => { r.currency === e && (c = r) }), c }, currencyConverter: function () { let r = yay_currency_data_args.converter_args.converterWrapper; e(r).length && e(r).each(function (r, t) { YayCurrency_Callback.Helper.doConverterCurrency(e(t)) }) }, doFormatNumber: function (e, r, t, c, o = !1) { var a, n; if ("N/A" === e || "" === e) return e; let s = isFinite(+(e = (e + "").replace(/[^0-9+\-Ee.]/g, ""))) ? +e : 0, l = isFinite(+r) ? Math.abs(r) : 0, u = void 0 === t ? "." : t, i = "", y; return (i = (l ? (a = s, "" + Math.round(a * (y = Math.pow(10, n = l))) / y) : "" + Math.round(s)).split("."))[0].length > 3 && (i[0] = i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, void 0 === c ? "," : c)), (i[1] || "").length < l && (i[1] = i[1] || "", i[1] += Array(l - i[1].length + 1).join("0")), o ? i.join(u) : i.join(u).replace(/([0-9]*\.0*[1-9]+)0+$/gm, "$1").replace(/.00+$/, "") }, roundedAmountByCurrency: function (e, r) { if (!r) return e; let { roundingType: t, roundingValue: c, subtractAmount: o, numberDecimal: a, decimalSeparator: n, thousandSeparator: s } = r; switch (t) { case "up": e = Math.ceil(e / c) * c - o; break; case "down": e = Math.floor(e / c) * c - o; break; case "nearest": e = Math.round(e / c) * c - o }let l = YayCurrency_Callback.Helper.doFormatNumber(e, Number(a), n, s, !0); return l }, doApplyResultConverter: function (r, t) { let c = r.find(yay_currency_data_args.converter_args.converterFrom), o = r.find(yay_currency_data_args.converter_args.converterTo), a = t.from_currency_code ? t.from_currency_code : e(c).val(), n = t.to_currency_code ? t.to_currency_code : e(o).val(), s = t.amount_value ? +t.amount_value : +e(r.find(yay_currency_data_args.converter_args.converterAmount)).val(); if (n === a) e(r.find(yay_currency_data_args.converter_args.converterResultValue)).text(s); else { let l = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(a), u = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(n), i = YayCurrency_Callback.Helper.getRateFeeByCurrency(u); if (l && a !== yayCurrency.default_currency_code) { let y = YayCurrency_Callback.Helper.getRateFeeByCurrency(l); s *= parseFloat(1 / y) } e(r.find(yay_currency_data_args.converter_args.converterResultValue)).text(YayCurrency_Callback.Helper.roundedAmountByCurrency(s * i, u)) } }, doConverterCurrency: function (r) { let t = r.find(yay_currency_data_args.converter_args.converterAmount), c = r.find(yay_currency_data_args.converter_args.converterFrom), o = r.find(yay_currency_data_args.converter_args.converterTo), a = r.find(yay_currency_data_args.converter_args.converterResultWrapper); e(c).change(function () { e(r.find(yay_currency_data_args.converter_args.converterResultFrom)).text(e(this).val()), YayCurrency_Callback.Helper.doApplyResultConverter(r, { from_currency_code: e(this).val() }) }), e(o).change(function () { e(r.find(yay_currency_data_args.converter_args.converterResultTo)).text(e(this).val()), YayCurrency_Callback.Helper.doApplyResultConverter(r, { to_currency_code: e(this).val() }) }), e(t).on("input", function () { let t = e(this).val(); e(this).val(t.replace(/\D/g, "")), t ? (e(a).show(), e(r.find(yay_currency_data_args.converter_args.converterResultAmount)).text(t), YayCurrency_Callback.Helper.doApplyResultConverter(r, { amount_value: t })) : e(a).hide() }), e(t).trigger("input"), e(c).trigger("change"), e(o).trigger("change") }, compatibleWithThirdPartyPlugins: function (t) { if (r.wc_price_calculator_params) { let c = YayCurrency_Callback.Helper.getCurrentCurrency(t), o = YayCurrency_Callback.Helper.getRateFeeByCurrency(c); r.wc_price_calculator_params.woocommerce_currency_pos = c.currencyPosition, r.wc_price_calculator_params.woocommerce_price_decimal_sep = c.decimalSeparator, r.wc_price_calculator_params.woocommerce_price_num_decimals = c.numberDecimal, r.wc_price_calculator_params.woocommerce_price_thousand_sep = c.thousandSeparator, r.wc_price_calculator_params.pricing_rules && r.wc_price_calculator_params.pricing_rules.forEach(e => { e.price = (parseFloat(e.price) * o).toString(), e.regular_price = (parseFloat(e.regular_price) * o).toString(), e.sale_price = (parseFloat(e.sale_price) * o).toString() }) } if (r.yayCurrency.ppc_paypal) { let a = "ppc_paypal_cart_or_product_page", n = YayCurrency_Callback.Helper.getCookie(a); "1" === yayCurrency.cart_page || "1" === yayCurrency.product_page ? n || YayCurrency_Callback.Helper.setCookie(a, "yes", +yayCurrency.cookie_lifetime_days) : n && YayCurrency_Callback.Helper.deleteCookie(a), e(document).on("visibilitychange", function () { if ("visible" === document.visibilityState) { let e = YayCurrency_Callback.Helper.getCookie(a); "1" === yayCurrency.cart_page || "1" === yayCurrency.product_page ? e || YayCurrency_Callback.Helper.setCookie(a, "yes", +yayCurrency.cookie_lifetime_days) : e && YayCurrency_Callback.Helper.deleteCookie(a) } }) } } } }(jQuery, window);